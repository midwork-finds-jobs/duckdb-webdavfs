# name: test/sql/secrets/create_secret_webdav.test
# description: Test WebDAV secret creation
# group: [secrets]

# Require webdav extension
require webdavfs

statement ok
CREATE SECRET webdav_test (
    TYPE WEBDAV,
    username 'test_user',
    password 'test_password',
    SCOPE 'webdav://example.com'
);

# Verify the secret exists
query I
SELECT count(*) FROM duckdb_secrets() WHERE name = 'webdav_test';
----
1

# Verify secret type
query I
SELECT type FROM duckdb_secrets() WHERE name = 'webdav_test';
----
webdav

# Test storagebox:// scope matching
statement ok
CREATE SECRET storagebox_test (
    TYPE WEBDAV,
    username 'u123456',
    password 'secret_password',
    SCOPE 'storagebox://u123456'
);

# Verify storagebox secret exists
query I
SELECT count(*) FROM duckdb_secrets() WHERE name = 'storagebox_test';
----
1

# Cleanup
statement ok
DROP SECRET webdav_test;

statement ok
DROP SECRET storagebox_test;
